/*!CK:4183869371!*//*1453170745,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["F7xI\/"]); }

__d('isEmpty',['invariant'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();function i(j){!!(j&&j[typeof Symbol==='function'?Symbol.iterator:'@@iterator']&&j.size!==undefined)?h(0):undefined;if(Array.isArray(j)){return j.length===0;}else if(typeof j==='object'){for(var k in j)return false;return true;}else return !j;}f.exports=i;},null);
__d('DeviceBasedAccount',['JSXDOM','cx'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();var j={create:function(k,l,m){return (h.div({className:"_5t1x",sigil:"account-container"},h.div({className:"_5t1y"},h.img({src:k,alt:l,className:"_5t1z"})),h.div({className:"_5t1-"},l)));}};f.exports=j;},null);
__d('MDeviceBasedAccountStore',['isEmpty','WebStorage'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();var j=':userchooser:osessusers',k={accountHasPin:function(l){return k._getAttributeOrNull(l,'is_pin_set')&&true||false;},accountExists:function(l){return k.getAccount(l)&&true||false;},getNonce:function(l){return k._getAttributeOrNull(l,'nonce');},getName:function(l){return k._getAttributeOrNull(l,'name');},getPic:function(l){return k._getAttributeOrNull(l,'pic_url');},getAccount:function(l){var m=k.getAccounts();return m[l];},removeAccount:function(l){var m=k.getAccounts();delete m[l];k._setStorageItem(m);},setAccount:function(l,m){var n=k.getAccounts(),o=n[l];if(o&&o.time>m.time)return;n[l]=m;k._setStorageItem(n);},getAccounts:function(){return k._getStorageItem()||{};},isEmpty:function(){return h(k._getStorageItem());},_getStorageItem:function(){if(!k._hasStorage())return;var l=k._getStorage().getItem(j);return l&&JSON.parse(l);},_setStorageItem:function(l){if(!k._hasStorage())return;var m=k._getStorage();i.setItemGuarded(m,j,JSON.stringify(l));},_hasStorage:function(){return !!k._getStorage();},_getStorage:function(){return i.getLocalStorage();},_getAttributeOrNull:function(l,m){var n=k.getAccount(l);return n&&n[m];}};f.exports=k;},null);
__d("XDeviceBasedLoginRequestPinController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/login\/device-based\/pin\/",{uid:{type:"Int",required:true},next:{type:"String"},errorcode:{type:"Int"},flow:{type:"Enum",defaultValue:"login",enumType:1}});},null);
__d('MLoginChooser',['DeviceBasedAccount','cx','CSS','DOM','isEmpty','MDeviceBasedAccountStore','MHistory','MViewport','Style','ServiceWorkerLoginAndLogout','Stratcom','URI','XDeviceBasedLoginRequestPinController'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t){if(c.__markCompiled)c.__markCompiled();var u=32,v=12,w=12,x=90,y={initChooser:function(z,aa,ba,ca,da){k.listen(ca,'click',null,this.switchAccountClicked.bind(this,z,aa));this.render(z,aa,ba);r.listen('m:viewport:update-complete',null,y.chooserWidthChange.bind(this,ba,x));y.chooserWidthChange(ba,x);},setUserNonceSuccess:function(z,aa){m.setAccount(z.id,z);window.location=aa;},setUserNonceFail:function(){},fillWithNonce:function(z,aa){z.value=m.getNonce(aa);},render:function(z,aa,ba){var ca=m.getAccounts();if(l(ca))return;for(var da in ca){var ea=h.create(m.getPic(da),m.getName(da),m.accountHasPin(da));k.appendContent(ba,ea);k.listen(ea,'click',null,this.userClicked.bind(this,z,da));}var fa=document.getElementById('root');j.addClass(fa,"_5t66");var ga=document.getElementById('header');j.addClass(ga,"_5t68");j.show(z);j.hide(aa);},userClicked:function(z,aa){q.login();if(m.accountHasPin(aa)===false){if(this.enabled!==false){this.enabled=false;var ba=k.find(z,'form','device-based-login-form');this.fillAndSubmitForm(ba,aa);setTimeout(this.enableForm.bind(this),5000);}}else{var ca=new s(n.getPath()),da=ca.getQueryData().next,ea=t.getURIBuilder().setInt('uid',aa).setString('next',da).getURI();n.pushState(ea);}},enableForm:function(){this.enabled=true;},fillAndSubmitForm:function(z,aa){var ba=z.querySelector("input[name='uid']");ba.value=aa;var ca=z.querySelector("input[name='device_nonce']");ca.value=m.getNonce(aa);z.submit();},switchAccountClicked:function(z,aa){var ba=document.getElementById('root');j.removeClass(ba,"_5t66");var ca=document.getElementById('header');j.removeClass(ca,"_5t68");j.hide(z);j.show(aa);},setupDescription:function(z){var aa=k.find(z,'div','description'),ba=k.find(z,'input'),ca=z.offsetHeight-1,da=ca-aa.offsetHeight;p.set(z,'height',ca+'px');p.set(aa,'position','absolute');p.set(aa,'bottom','0');k.listen(ba,'change',null,this.rememberAccountToggleChange.bind(this,z,ba,ca,da));setTimeout(j.addClass.bind(j,z,"_5sri"),20);},chooserWidthChange:function(z,aa){var ba=k.scry(z,'div','account-container'),ca=y.calculateChooserPadding(aa,ba.length);for(var da=0;da<ba.length;da++){if(da==ba.length-1)continue;p.set(ba[da],'padding-right',ca.elements+'px');}p.set(z,'padding-left',ca.edges+'px');p.set(z,'padding-right',ca.edges+'px');},rememberAccountToggleChange:function(z,aa,ba,ca){if(aa.checked){p.set(z,'height',ba+'px');}else p.set(z,'height',ca+'px');},calculateChooserPadding:function(z,aa){var ba=o.getWidth(),ca=z/4,da=z-z/20,ea=z+w,fa=ba-u*2,ga=(fa+w)/ea;if(ga>=aa)return {edges:u,elements:w};fa=ba-v*2;ga=(fa+w)/ea;if(ga>=aa)return {edges:v,elements:w};fa=ba-u;ga=(fa+w)/ea;var ha=0,ia=0,ja=z-da,ka=(fa+w)%ea;if(ka>=ca&&ka<=da){ha=Math.ceil(ga);}else if(ka<ca){ha=Math.floor(ga);ia=ka+w+ja;}else{ha=Math.ceil(ga);var la=z-ka;ia=ja-la;}var ma=ia/(ha-1),na=w+ma;return {edges:u,elements:Math.floor(na)};}};f.exports=y;},null);